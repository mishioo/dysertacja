\documentclass[a4paper, 12pt]{book}
\usepackage[total={6in, 9in}, left=1in, right=1in]{geometry}

%% font encoding
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

%% normal font
\usepackage{lmodern}

%% language dependent
\usepackage[polish]{babel}
\usepackage{polski}
\usepackage[autostyle]{csquotes}
\usepackage{indentfirst}


% pretty tabs
% do I need it?
% \usepackage{booktabs}


%% Bibliography and citations setup
% based on https://tex.stackexchange.com/q/139158
\usepackage[
    citestyle=numeric,
    % bibstyle=authoryear,  % needed only for traditional bibliography
    sorting=none,
    backref=true,
    citetracker,
    backend=biber,
    % autocite=footnote,  % not wanted in draft
    labeldateparts,  % make year of publication available
    giveninits=true,  % names as initials
    url=false,  % suppress url everywhere but in `online'
    maxbibnames=3,  % if more than 3 autors, produce et al.
]{biblatex}
% suppress `In:' in article citations
% from https://tex.stackexchange.com/a/10686/223674
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
% suppress title of articles in citations
\DeclareFieldFormat[article]{title}{}
% suppress ISSN
\AtEveryCitekey{\clearfield{issn}}
% punctuation in autocite
\DeclareAutoCiteCommand{footnote}[r]{\footcite}{\footcites}
% references location
\addbibresource{refs.bib}

%% define shortcuts for colors from Wong's palette
\usepackage{xcolor}
\definecolor{wongblack}{HTML}{000000}
\definecolor{wongorange}{HTML}{E69F00}
\definecolor{wongsky}{HTML}{56B4E9}
\definecolor{wonggreen}{HTML}{009E73}
\definecolor{wongyellow}{HTML}{F0E442}
\definecolor{wongblue}{HTML}{0072B2}
\definecolor{wongvermillion}{HTML}{D55E00}
\definecolor{wongpurple}{HTML}{CC79A7}


%% TODOs in form of inline notes
\newcommand{\todo}[2][]{{ \color{wongpurple}[TODO: #2]}}


%% setup code snippets
\usepackage{inconsolata}  % monospaced font
\usepackage{listings}  % code listings
\lstset{
    breaklines=true,
    % numbers=left,
    numberstyle=\tiny,
    basicstyle=\ttfamily,
    keywordstyle=\color{wongvermillion},
    commentstyle=\color{wongsky},
    stringstyle=\color{wonggreen},
    extendedchars=\true,
    inputencoding=utf8,
    literate={ą}{{\k{a}}}1
             {Ą}{{\k{A}}}1
             {ę}{{\k{e}}}1
             {Ę}{{\k{E}}}1
             {ó}{{\'o}}1
             {Ó}{{\'O}}1
             {ś}{{\'s}}1
             {Ś}{{\'S}}1
             {ł}{{\l{}}}1
             {Ł}{{\L{}}}1
             {ż}{{\.z}}1
             {Ż}{{\.Z}}1
             {ź}{{\'z}}1
             {Ź}{{\'Z}}1
             {ć}{{\'c}}1
             {Ć}{{\'C}}1
             {ń}{{\'n}}1
             {Ń}{{\'N}}1
            %  {\-}{}{0\discretionary{-}{}{}
}  % last one to enable word breaks


%% Create scheme floating environment
\usepackage{newfloat}
% must be done before loading chemmacros to prevent name conflict
\DeclareFloatingEnvironment{scheme}

% continuos numbering of floats
\usepackage{chngcntr}
\counterwithout{scheme}{chapter}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

%% all tufte floats behave as standard
\newenvironment{marginscheme}[1][]{\begin{scheme}[h!]\centering}{\end{scheme}}
\newenvironment{marginfigure}[1][]{\begin{figure}[h!]\centering}{\end{figure}}
\newenvironment{margintable}[1][]{\begin{table}[h!]\centering}{\end{table}}
\renewenvironment{scheme*}[1][]{\begin{scheme}[h!]}{\end{scheme}}
\renewenvironment{figure*}[1][]{\begin{figure}[h!]}{\end{figure}}
\renewenvironment{table*}[1][]{\begin{table}[h!]}{\end{table}}
\newenvironment{fullwidth}[1][]{}{}
\newenvironment{doublespace}[1][]{}{}
% setfloatalignment do nothing
\newcommand{\setfloatalignment}[1]{\ignorespaces}
% set includegraphics to do nothing
% \renewcommand{\includegraphics}[1]{\centering [RYSUNEK]}
\renewcommand{\footnote}[2][]{ {\color{wongblue}[PRZYPIS: #2]}}

%% enable access to nested subdirs
\usepackage{import}
% signal a relative path - produces path of current import dir
\makeatletter\def\relpath{\import@path}\makeatother

%% provide images replacement

% patch for importing svg file functionality
% extracts cmpd declarations from pdf_tex, converts to labelcmpd
% requires --shell-escape
% #1 - path to file, optional
% #2 - name of the file to be imported
\usepackage[unique=true,dir=bashout]{bashful}
\makeatletter
\newcommand{\includesvg}[2][]{%
  \begingroup%
  \color{wongvermillion}
  \catcode`\_=12\relax%
  \splice{%
    if grep -qP '\@backslashchar\@backslashchar cmpd{[a-zA-Z0-9:.\@backslashchar-]*}' ../\relpath#1#2.pdf_tex; then
      echo '[NA RYSUNKU ZWI\@backslashchar k{A}ZKI';
      grep -oP '\@backslashchar\@backslashchar cmpd{[a-zA-Z0-9:.\@backslashchar-]*}' ../\relpath#1#2.pdf_tex;
      echo ']';
    else
      echo "[RYSUNEK BEZ NUMEROWANYCH ZWI\@backslashchar k{A}ZK\@backslashchar 'OW]";
    fi
    % only print \cmpd{...}
    % grep -oP '\@backslashchar\@backslashchar cmpd{[a-zA-Z0-9:.\@backslashchar-]*}' ../\relpath#1#2.pdf_tex%
    % convert to \labelcmpd{...}
    % sed -n 's/.*\@backslashchar\@backslashchar\@backslashchar(cmpd{[a-zA-Z0-9:.\@backslashchar-]*}\@backslashchar).*/%
    % \@backslashchar\@backslashchar label\@backslashchar1/p' ../\relpath#1#2.pdf_tex%
  }%
  \endgroup%
}
\makeatother
% from http://www.tex.ac.uk/tex-archive/info/svg-inkscape/InkscapePDFLaTeX.pdf
% and https://tex.stackexchange.com/a/17491/223674

\usepackage{nopageno}  % no page numbers


%% chemistry packages
\usepackage{chemmacros}  % various chemistry typesetting macros (e.g. \iupac)
\usechemmodule{spectroscopy}  % adds /NMR command for typesetting of experimental data
\chemsetup{greek = upgreek}  % for upright Greek letters in chemical formulas
\usechemmodule{units}  % siunitx for typesetting units
\DeclareSIUnit{\volume}{vol.}
\DeclareSIUnit{\equiv}{equiv.}

\usepackage{chemformula}  % for typesetting chemical equations
\setchemformula{circled=all}

\usepackage{chemnum}  % for automated structures numeration


%% list of acronyms
\usepackage[acronym, nonumberlist, style=list, nogroupskip]{glossaries}
% make list of abbrev a section rather than a chapter
\makeatletter
\renewcommand*{\@@glossarysec}{section}%
\makeatother
% acronyms definitions in separate file
\input{acronyms}


%% LOCALIZATION
%% Adjust babel translations of floats names
\addto\captionspolish{\renewcommand{\schemename}{Schemat}}  % for Scheme -> Schemat; babel doesn't change it
\addto\captionspolish{\renewcommand{\tablename}{Tabela}}  % change babel's Tablica -> Tabela

%% Adjust floats names in references
\usepackage[nameinlink]{cleveref}
\crefname{figure}{rys.}{rys.}
\Crefname{figure}{Rys.}{Rys.}
\crefname{scheme}{schem.}{schem.}
\Crefname{scheme}{Schem.}{Schem.}
% and translate ceveref's conjunctions
\newcommand{\crefrangeconjunction}{ do~}
\newcommand{\crefpairconjunction}{ i~}
\newcommand{\creflastconjunction}{, oraz }

% chemnum package related
\DeclareTranslation{polish}{chemnum-sep-two}{~oraz~}
\DeclareTranslation{polish}{chemnum-sep-last-two}{,~oraz~}

% biblatex related
\DefineBibliographyStrings{polish}{
  urlseen = {dostęp}
}

%% typesetting dashes
\usepackage[shortcuts,shortemdash]{extdash}
\sisetup{range-phrase = {\--}, range-units=single}


%% vertical space between marginals
% \setlength\marginparpush{12pt}
% not needed in draft


%% slightly more loose typesetting of whitespaces
\tolerance 1414
\hbadness 1414
\emergencystretch 1.5em
\hfuzz 0.3pt
\widowpenalty=10000
\vfuzz \hfuzz
% glues text up rather than distributing on partially empty page
\raggedbottom


%% Title page layout setup
% define subtitle
\makeatletter
\newcommand{\plainsubtitle}{}%     plain-text-only subtitle
\newcommand{\subtitle}[1]{%
    \gdef\@subtitle{#1}%
    \renewcommand{\plainsubtitle}{#1}% use provided plain-text title
}
\newcommand{\plainpublisher}{}%     plain-text-only subtitle
\newcommand{\publisher}[1]{%
    \gdef\@publisher{#1}%
    \renewcommand{\plainpublisher}{#1}% use provided plain-text title
}

% full title page
\renewcommand{\maketitle}[0]{%
    {%
    \sffamily%
    \fontsize{16}{18}\selectfont\noindent\@author\par%
    \vspace{11.5pc}%
    \fontsize{28}{34}\selectfont\noindent\nohyphenation\textit{\@title}\par%
    \vspace{5pc}%
    \fontsize{18}{20}\selectfont\noindent{\plainsubtitle}\par%
    \vspace{2pc}%
    \fontsize{14}{16}\selectfont\noindent\plainpublisher\par%
    }
}
\makeatother

\usepackage{graphicx}
% \newsavebox{\titleimage}
% \savebox{\titleimage}{\includegraphics[height=7\baselineskip]{example-image}}

\title{Badania nad chemoselektywnymi metodami aktywacji amidowych grup karbonylowych na~czynniki nukleofilowe}
\subtitle{\textbf{Praca doktorska} \\ przygotowana pod kierunkiem \\ prof. Bartłomieja Furmana}
\author{Michał M. Więcław}
\publisher{Instytut Chemii Organicznej \\ Polskiej Akademii Nauk}

%% TABLE OF CONTENTS SETUP
% show chapters and sections in table of contents
\setcounter{tocdepth}{1}

\begin{document}

\frontmatter
\maketitle

% acknowledgements
% \cleardoublepage
% \thispagestyle{empty}
% ~\vfill
% \vfill
% \begin{fullwidth}
% \begin{doublespace}
% \raggedleft\noindent\fontsize{16}{20}\selectfont\itshape
% \nohyphenation
% Gorąco dziękuję Magdalenie,\\
% bez wsparcia której ta praca nie zostałaby ukończona.
% \end{doublespace}
% \end{fullwidth}
% \vfill

% \tableofcontents

\input{preface}

\mainmatter
% widths of text elements
% zwykły tekst \printinunitsof{cm}\prntlen{\textwidth}\\  % 10.69847 cm
% margines \printinunitsof{cm}\prntlen{\marginparwidth}\\ %  4.93929 cm
% przerwy \printinunitsof{cm}\prntlen{\marginparsep}      %  0.81987 cm
%                                                 SUMA:     16.45763 cm

\import{chapter-1}{chapter}

% \chapter{In vitro}

% \chapter{In silico}
% \section{Obliczenia mechanizmu}
% \section{Symulacja widm}

% \chapter{In machina}
% \section{Istota programu}
% \section{Wybór języka programowania}

% \chapter{In detail}
% \section{Procedury}
% \section{Analizy}

\backmatter

\printbibliography

\end{document}
