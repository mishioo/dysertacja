\ProvidesPackage{preambule}

%% font encoding
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}


%% language dependent
\usepackage[polish]{babel}
\usepackage{polski}
\usepackage[autostyle]{csquotes}
\usepackage{indentfirst}


% preety tabs
% do I need it?
% \usepackage{booktabs}


%% Helper for TODOs
\usepackage[
    linecolor=red,
    backgroundcolor=white,
    bordercolor=red,
    textcolor=red,
    textsize=footnotesize,
]{todonotes}


%% Bibliography and citations setup
% based on https://tex.stackexchange.com/q/139158
\usepackage[
    citestyle=verbose-ibid,  % first occurrence verbose, next cite:short
    % bibstyle=authoryear,  % needed only for traditional bibliography
    backref=true,
    citetracker,
    backend=biber,
    autocite=footnote,  % cooperate with tufte-latex
    labeldateparts,  % make year of publication available
]{biblatex}
\addbibresource{refs.bib}
% redefine cite:short to give author-year
% also set the name output to always use family-given
\DeclareNameAlias{default}{family-given}
\renewbibmacro*{cite:short}{%
  \printnames{labelname}%
  \setunit*{\printdelim{nameyeardelim}}%
  \iffieldundef{labelyear}
    {}
    {\printtext[parens]{\printlabeldateextra}},  % comma is printed
  \printtext[bibhyperlink]{%  make it a link to citation
    \bibstring{backrefpage}\ppspace%  "cyt. na s. "
    \printlist[][-1]{pageref}}%  page number of first occurrence
}


%% list of acronyms
\usepackage[acronym, nonumberlist, style=list, nogroupskip]{glossaries}
% make list of abbrev a section rather than a chapter
\makeatletter
\renewcommand*{\@@glossarysec}{section}%
\makeatother
% acronyms definitions in separate file
\input{acronyms}


%% define shortcuts for colors from Wong's palette
\usepackage{xcolor}
\definecolor{wongblack}{HTML}{000000}
\definecolor{wongorange}{HTML}{E69F00}
\definecolor{wongsky}{HTML}{56B4E9}
\definecolor{wonggreen}{HTML}{009E73}
\definecolor{wongyellow}{HTML}{F0E442}
\definecolor{wongblue}{HTML}{0072B2}
\definecolor{wongvermillion}{HTML}{D55E00}
\definecolor{wongpurple}{HTML}{CC79A7}


%% setup code snippets
\usepackage{inconsolata}  % monospaced font
\usepackage{listings}  % code listings
\lstset{
    breaklines=true,
    numbers=left,
    numberstyle=\tiny,
    basicstyle=\ttfamily,
    keywordstyle=\color{wongvermillion},
    commentstyle=\color{wongsky},
    stringstyle=\color{wonggreen},
    extendedchars=\true,
    inputencoding=utf8,
    literate={ą}{{\k{a}}}1
             {Ą}{{\k{A}}}1
             {ę}{{\k{e}}}1
             {Ę}{{\k{E}}}1
             {ó}{{\'o}}1
             {Ó}{{\'O}}1
             {ś}{{\'s}}1
             {Ś}{{\'S}}1
             {ł}{{\l{}}}1
             {Ł}{{\L{}}}1
             {ż}{{\.z}}1
             {Ż}{{\.Z}}1
             {ź}{{\'z}}1
             {Ź}{{\'Z}}1
             {ć}{{\'c}}1
             {Ć}{{\'C}}1
             {ń}{{\'n}}1
             {Ń}{{\'N}}1
            %  {\-}{}{0\discretionary{-}{}{}
}  % last one to enable word breaks


%% Create scheme floating environment
\usepackage{newfloat}
% must be done before loading chemmacros to prevent name conflict
\DeclareFloatingEnvironment{scheme}

%% provide tufte-style schemes
\makeatletter
%% scheme on tufte margin
\newenvironment{marginscheme}[1][-1.2ex]%
  {\begin{@tufte@margin@float}[#1]{scheme}}
  {\end{@tufte@margin@float}}
%% scheme as standard tufte float
\renewenvironment{scheme}[1][htbp]%
  {\ifvmode\else\unskip\fi\begin{@tufte@float}[#1]{scheme}{}}
  {\end{@tufte@float}}
% Full-width scheme (starred)
\renewenvironment{scheme*}[1][htbp]%
  {\ifvmode\else\unskip\fi\begin{@tufte@float}[#1]{scheme}{star}}
  {\end{@tufte@float}}
\makeatother


%% chemistry packages
\usepackage{chemmacros}  % various chemistry typesetting macros (e.g. \iupac)
\usechemmodule{spectroscopy}  % adds /NMR command for typesetting of experimental data
\chemsetup{greek = upgreek}  % for upright Greek letters in chemical formulas
\usechemmodule{units}  % siunitx for typesetting units
\DeclareSIUnit{\volume}{vol.}
\DeclareSIUnit{\equiv}{equiv.}

\usepackage{chemformula}  % for typesetting chemical equations

\usepackage{chemnum}  % for automated structures numeration
\setchemnum{replace-style = \fontsize{10}{12}}  % change size of tags in schemes


%% LOCALIZATION
%% Adjust babel translations of floats names
\addto\captionspolish{\renewcommand{\schemename}{Schemat}}  % for Scheme -> Schemat; babel doesn't change it
\addto\captionspolish{\renewcommand{\tablename}{Tabela}}  % change babel's Tablica -> Tabela

%% Adjust floats names in references
\usepackage{cleveref}
\crefname{figure}{rys.}{rys.}
\Crefname{figure}{Rys.}{Rys.}
\crefname{scheme}{schem.}{schem.}
\Crefname{scheme}{Schem.}{Schem.}

% chemnum package related
\DeclareTranslation {polish} {chemnum-sep-two} {~oraz~}
\DeclareTranslation {polish} {chemnum-sep-last-two} {,~oraz~}


%% typesetting dashes
\usepackage[shortcuts]{extdash}


%% Title page layout setup
% define subtitle
\makeatletter
\newcommand{\plainsubtitle}{}%     plain-text-only subtitle
\newcommand{\subtitle}[1]{%
    \gdef\@subtitle{#1}%
    \renewcommand{\plainsubtitle}{#1}% use provided plain-text title
}
\makeatother

% full title page
\renewcommand{\maketitlepage}[0]{%
    \cleardoublepage%
    {%
    \sffamily%
    \begin{fullwidth}%
    \fontsize{16}{18}\selectfont\noindent\textcolor{darkgray}{\allcaps{\thanklessauthor}}\par%
    \vspace{11.5pc}%
    \fontsize{28}{34}\selectfont\noindent\nohyphenation\raggedright\textcolor{darkgray}{\textit{\thanklesstitle}}\par%
    \vspace{5pc}%
    \fontsize{18}{20}\selectfont\noindent\raggedleft\textcolor{darkgray}{\textsc{\plainsubtitle}}\par%
    \vfill%
    \fontsize{14}{16}\selectfont\noindent\raggedright\allcaps{\thanklesspublisher}\par%
    \end{fullwidth}%
    }
    \thispagestyle{empty}%
    \clearpage%
}

\usepackage{graphicx}
\newsavebox{\titleimage}
% \savebox{\titleimage}{\includegraphics[height=7\baselineskip]{example-image}}

\title[Badania nad chemoselektywnymi metodami\ldots]%
    {Badania nad chemoselektywnymi metodami aktywacji amidowych grup karbonylowych na~czynniki nukleofilowe}
\subtitle{\textbf{Praca doktorska} \\ przygotowana pod kierunkiem \\ prof. Bartłomieja Furmana}
\author{Michał M. Więcław}
\publisher{Instytut Chemii Organicznej \\ Polskiej Akademii Nauk}
